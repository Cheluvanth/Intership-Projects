##### -- 1. Create Views for Officer Workloads 

##### -- This view shows each officer and the number of cases they are currently leading (OPEN or UNSOLVED).



CREATE VIEW OfficerWorkload\_v AS

SELECT

&nbsp;   O.officer\_id,

&nbsp;   O.rank,

&nbsp;   O.first\_name,

&nbsp;   O.last\_name,

&nbsp;   COUNT(C.case\_id) AS active\_cases\_count,

&nbsp;   SUM(CASE WHEN C.status = 'SOLVED' THEN 1 ELSE 0 END) AS solved\_cases\_count

FROM

&nbsp;   Officers O

LEFT JOIN

&nbsp;   Cases C ON O.officer\_id = C.lead\_officer\_id

WHERE

&nbsp;   C.status IN ('OPEN', 'UNSOLVED', 'SOLVED') -- Include SOLVED to track total success rate, but focus on OPEN/UNSOLVED for workload

GROUP BY

&nbsp;   O.officer\_id, O.rank, O.first\_name, O.last\_name;





###### -- Example: Display the officer workload view



SELECT \* FROM OfficerWorkload\_v ORDER BY active\_cases\_count DESC;





